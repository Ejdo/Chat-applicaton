(()=>{"use strict";var e={485:(e,t,n)=>{n(8964);var s=n(1957),o=n(1947),r=n(499),i=n(9835);function a(e,t,n,s,o,r){const a=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(a)}const c=(0,i.aZ)({name:"App"});var l=n(1639);const u=(0,l.Z)(c,[["render",a]]),h=u;var d=n(192),m=n(3340),v=n(8339);const f=[{path:"/",redirect:()=>({name:"chat"})},{path:"/auth",component:()=>Promise.all([n.e(736),n.e(499)]).then(n.bind(n,9499)),children:[{path:"login",component:()=>Promise.all([n.e(736),n.e(706)]).then(n.bind(n,706)),name:"login",meta:{guestOnly:!0}},{path:"register",component:()=>Promise.all([n.e(736),n.e(641)]).then(n.bind(n,3641)),name:"register",meta:{guestOnly:!0}}]},{path:"/chat",meta:{requiresAuth:!0},component:()=>Promise.all([n.e(736),n.e(728)]).then(n.bind(n,9728)),children:[{path:":channel?",component:()=>Promise.all([n.e(736),n.e(68)]).then(n.bind(n,2068)),name:"chat",meta:{title:null}}]},{path:"/:catchAll(.*)*",name:"not_found",component:()=>Promise.all([n.e(736),n.e(230)]).then(n.bind(n,6230))}],g=f,p=(0,m.BC)((function(){const e=v.r5,t=(0,v.p7)({scrollBehavior:()=>({left:0,top:0}),routes:g,history:e("")});return t}));async function y(e,t){const s=e(h);s.use(o.Z,t);const i="function"===typeof d["default"]?await(0,d["default"])({}):d["default"],{storeKey:a}=await Promise.resolve().then(n.bind(n,192)),c=(0,r.Xl)("function"===typeof p?await p({store:i}):p);return i.$router=c,{app:s,store:i,storeKey:a,router:c}}var T=n(6827);const S={config:{notify:{}},plugins:{Notify:T.Z}},b="";async function E({app:e,router:t,store:n,storeKey:s},o){let r=!1;const i=e=>{try{return t.resolve(e).href}catch(n){}return Object(e)===e?null:e},a=e=>{if(r=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=i(e);null!==t&&(window.location.href=t,window.location.reload())},c=window.location.href.replace(window.location.origin,"");for(let u=0;!1===r&&u<o.length;u++)try{await o[u]({app:e,router:t,store:n,ssrContext:null,redirect:a,urlPath:c,publicPath:b})}catch(l){return l&&l.url?void a(l.url):void console.error("[Quasar] boot error:",l)}!0!==r&&(e.use(t),e.use(n,s),e.mount("#q-app"))}y(s.ri,S).then((e=>{const[t,s]=void 0!==Promise.allSettled?["allSettled",e=>e.map((e=>{if("rejected"!==e.status)return e.value.default;console.error("[Quasar] boot error:",e.reason)}))]:["all",e=>e.map((e=>e.default))];return Promise[t]([Promise.resolve().then(n.bind(n,4136)),Promise.resolve().then(n.bind(n,9482)),Promise.resolve().then(n.bind(n,4479))]).then((t=>{const n=s(t).filter((e=>"function"===typeof e));E(e,n)}))}))},9482:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var s=n(3340),o=n(3742),r=function(e,t,n,s){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{c(s.next(e))}catch(t){r(t)}}function a(e){try{c(s["throw"](e))}catch(t){r(t)}}function c(e){e.done?n(e.value):o(e.value).then(i,a)}c((s=s.apply(e,t||[])).next())}))};const i=e=>({name:"login",query:{redirect:e.fullPath}}),a=(0,s.xr)((({router:e,store:t})=>{o.E5.onLogout((()=>{e.push(i(e.currentRoute.value))})),e.beforeEach((e=>r(void 0,void 0,void 0,(function*(){const n=yield t.dispatch("auth/check");return e.meta.requiresAuth&&!n?i(e):e.meta.guestOnly&&n?{name:"home"}:void 0}))))}))},4136:(e,t,n)=>{n.r(t),n.d(t,{api:()=>a,default:()=>l});var s=n(3340),o=n(9981),r=n.n(o),i=n(3742);const a=r().create({baseURL:"http://zjavka.sk",withCredentials:!0,headers:{}}),c=!1;a.interceptors.request.use((e=>{const t=i.E5.getToken();return void 0!==e.headers&&null!==t&&(e.headers.Authorization=`Bearer ${t}`),c&&console.info("-> ",e),e}),(e=>(c&&console.error("-> ",e),Promise.reject(e)))),a.interceptors.response.use((e=>(c&&console.info("<- ",e),e)),(e=>(c&&console.error("<- ",e.response),401!==e.response.status||e.response.config.dontTriggerLogout||i.E5.logout(),Promise.reject(e))));const l=(0,s.xr)((({app:e})=>{e.config.globalProperties.$axios=r(),e.config.globalProperties.$api=a}))},4479:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i,io:()=>r});var s=n(3340),o=n(6073);const r=o.C.createManager("http://zjavka.sk"),i=(0,s.xr)((e=>{e.app.config.globalProperties.$io=r,o.C.boot(e)}))},6073:(e,t,n)=>{n.d(t,{C:()=>i});var s=n(3819),o=n(3742);const r=!1;class i{constructor(e){this.namespace=e,this.$socket=null,this.constructor.addInstance(this)}static getManager(){if(!this.manager)throw new Error('Socket.io Manager not created. Please call "SocketManager.createManager(uri)" in quasar boot file.');return this.manager}static createManager(e){const t=new s.dK(e,{autoConnect:!1});return this.manager=t,t}static addInstance(e){if(this.namespaces.has(e.namespace))throw new Error(`Duplicate socket manager created for namespace "${e.namespace}".`);this.namespaces.add(e.namespace),null!==this.params?this.bootInstance(e):this.instances.push(e)}static destroyInstance(e){this.instances=this.instances.filter((t=>t!==e)),this.namespaces.delete(e.namespace),e.socket.disconnect(),e.socket.removeAllListeners(),e.$socket=null}static bootInstance(e){e.subscribe(this.params),e.socket.connect()}static boot(e){if(this.params)throw new Error("SocketManager is already booted. Call it once from quasar boot file.");this.params=e,this.instances.forEach((e=>this.bootInstance(e))),this.instances=[]}get socket(){return this.$socket||(this.$socket=this.socketWithAuth()),this.$socket}socketWithAuth(){const e=this.constructor.getManager(),t=e.socket(this.namespace,{auth:{token:o.E5.getToken()}});return t.on("connect_error",(e=>{var n;if(r&&console.error(`${this.namespace} [connect_error]`,e.message,e.data),401===(null===(n=e.data)||void 0===n?void 0:n.status)){const e=o.E5.onChange((n=>{t.auth={token:n},e(),t.connect()}))}})),r&&(t.on("connect",(()=>{console.info(`${this.namespace} [connect]`)})),t.on("disconnect",(e=>{console.info(`${this.namespace} [disconnect]`,e)})),t.on("error",(e=>{console.error(`${this.namespace} [error]`,e.message)})),t.onAny(((e,...t)=>{console.info(`${this.namespace} [${e}]`,t)}))),t}emitAsync(e,...t){return new Promise(((n,s)=>{this.socket.emit(e,...t,(([e,t])=>{e?s(e):n(t)}))}))}destroy(){this.constructor.destroyInstance(this)}}i.instances=[],i.namespaces=new Set,i.params=null},3742:(e,t,n)=>{n.d(t,{cG:()=>p,E5:()=>r,ON:()=>l,Qs:()=>f});var s=n(3703);class o{constructor(e){this.storageKey=e,this.currentToken=this.getToken(),this.onChangeListeners=[],this.storageListener=e=>{e.key===this.storageKey&&this.notifyListeners()},window.addEventListener("storage",this.storageListener)}notifyListeners(){const e=this.getToken();this.currentToken!==e&&(this.onChangeListeners.forEach((t=>t(e,this.currentToken))),this.currentToken=e)}onChange(e){return this.onChangeListeners.push(e),null!==this.currentToken&&window.setTimeout((()=>e(this.currentToken,null)),0),()=>{const t=this.onChangeListeners.indexOf(e);t>=0&&this.onChangeListeners.splice(t,1)}}onLogout(e){return this.onChange((t=>{null===t&&e()}))}getToken(){return s.Z.getItem(this.storageKey)}removeToken(){s.Z.remove(this.storageKey),this.notifyListeners()}logout(){return this.removeToken()}setToken(e){s.Z.set(this.storageKey,e),this.notifyListeners()}}const r=new o("auth_token");var i=n(4136),a=function(e,t,n,s){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{c(s.next(e))}catch(t){r(t)}}function a(e){try{c(s["throw"](e))}catch(t){r(t)}}function c(e){e.done?n(e.value):o(e.value).then(i,a)}c((s=s.apply(e,t||[])).next())}))};class c{me(e=!1){return a(this,void 0,void 0,(function*(){return i.api.get("auth/me",{dontTriggerLogout:e}).then((e=>e.data)).catch((e=>{var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)?null:Promise.reject(e)}))}))}register(e){return a(this,void 0,void 0,(function*(){const t=yield i.api.post("auth/register",e);return t.data}))}login(e){return a(this,void 0,void 0,(function*(){const t=yield i.api.post("auth/login",e);return t.data}))}logout(){return a(this,void 0,void 0,(function*(){yield i.api.post("auth/logout")}))}}const l=new c;var u=n(6073),h=n(6827),d=n(4962);class m extends u.C{subscribe({store:e}){const t=this.namespace.split("/").pop();this.socket.on("message",(n=>{var s,o,r,i;2!==(null===(s=e.state.auth.user)||void 0===s?void 0:s.state)&&1!==(null===(o=e.state.auth.user)||void 0===o?void 0:o.state)&&h.Z.create({caption:n.author.username,message:n.content}),d.Z.appVisible||2===(null===(r=e.state.auth.user)||void 0===r?void 0:r.state)||1===(null===(i=e.state.auth.user)||void 0===i?void 0:i.state)||("granted"===Notification.permission?new Notification("Message from "+n.author.username,{body:n.content}):Notification.requestPermission()),e.commit("channels/NEW_MESSAGE",{channel:t,message:n})}))}addMessage(e){return this.emitAsync("addMessage",e)}loadMessages(){return this.emitAsync("loadMessages")}inviteUser(e){return this.emitAsync("inviteToChannel",e)}revokeUser(e){return this.emitAsync("revokeUser",e)}leaveChannel(){return this.emitAsync("leaveChannel")}getMembers(){return this.emitAsync("loadUsers")}}class v{constructor(){this.channels=new Map}join(e){if(this.channels.has(e))throw new Error(`User is already joined in channel "${e}"`);const t=new m(`/channels/${e}`);return this.channels.set(e,t),t}leave(e){const t=this.channels.get(e);return!!t&&(t.destroy(),this.channels.delete(e))}in(e){return this.channels.get(e)}}const f=new v;class g extends u.C{subscribe({store:e}){this.socket.on("user:list",(e=>{console.log("Online users list",e)})),this.socket.on("user:online",(t=>{console.log("User is online",t),e.commit("channels/SET_USER_STATUS",{user:t,statusId:0})})),this.socket.on("user:offline",(t=>{console.log("User is offline",t),e.commit("channels/SET_USER_STATUS",{user:t,statusId:1})})),this.socket.on("user:dnd",(t=>{console.log("User is dnd",t),e.commit("channels/SET_USER_STATUS",{user:t,statusId:2})})),this.socket.on("newChannel",(t=>{e.dispatch("channels/join",t.name)})),r.onChange((e=>{e?this.socket.connect():this.socket.disconnect()}))}inviteUser(e,t){return this.emitAsync("inviteToChannel",e,t)}changeStatus(e){return this.emitAsync("changeStatus",e)}}const p=new g("/")},192:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U,storeKey:()=>R,useStore:()=>M});var s=n(3340),o=n(3100);function r(){return{user:null,status:"pending",errors:[]}}const i=r;var a=n(3742),c=n(4136),l=function(e,t,n,s){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{c(s.next(e))}catch(t){r(t)}}function a(e){try{c(s["throw"](e))}catch(t){r(t)}}function c(e){e.done?n(e.value):o(e.value).then(i,a)}c((s=s.apply(e,t||[])).next())}))};const u={check({state:e,commit:t,dispatch:n}){var s;return l(this,void 0,void 0,(function*(){try{t("AUTH_START");const o=yield a.ON.me();return(null===o||void 0===o?void 0:o.id)!==(null===(s=e.user)||void 0===s?void 0:s.id)&&(yield c.api.get("channels/index").then((e=>{e.data.forEach((e=>n("channels/join",e.name,{root:!0})))}))),t("AUTH_SUCCESS",o),null!==o}catch(o){throw t("AUTH_ERROR",o),o}}))},register({commit:e},t){return l(this,void 0,void 0,(function*(){try{e("AUTH_START");const n=yield a.ON.register(t);return e("AUTH_SUCCESS",null),n}catch(n){throw e("AUTH_ERROR",n),n}}))},login({commit:e},t){return l(this,void 0,void 0,(function*(){try{e("AUTH_START");const n=yield a.ON.login(t);return e("AUTH_SUCCESS",null),a.E5.setToken(n.token),n}catch(n){throw e("AUTH_ERROR",n),n}}))},logout({commit:e,dispatch:t}){return l(this,void 0,void 0,(function*(){try{e("AUTH_START"),yield a.ON.logout(),yield t("channels/leave",null,{root:!0}),e("AUTH_SUCCESS",null),a.E5.removeToken()}catch(n){throw e("AUTH_ERROR",n),n}}))},setStatus({commit:e},t){"Online"===t?e("SET_STATUS",0):"Offline"===t?e("SET_STATUS",1):"Do not disturb"===t&&e("SET_STATUS",2)}},h=u,d={isAuthenticated(e){return null!==e.user},getName(e){var t;return null===(t=e.user)||void 0===t?void 0:t.username}},m=d,v={AUTH_START(e){e.status="pending",e.errors=[]},AUTH_SUCCESS(e,t){e.status="success",e.user=t},AUTH_ERROR(e,t){e.status="error",e.errors=t},SET_STATUS(e,t){e.user&&(a.cG.changeStatus(t),e.user.state=t)}},f=v,g={namespaced:!0,actions:h,getters:m,mutations:f,state:i},p=g;function y(){return{loading:!1,error:null,messages:{},channelMembers:{},active:null,channelFilter:""}}var T=n(6827),S=function(e,t,n,s){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{c(s.next(e))}catch(t){r(t)}}function a(e){try{c(s["throw"](e))}catch(t){r(t)}}function c(e){e.done?n(e.value):o(e.value).then(i,a)}c((s=s.apply(e,t||[])).next())}))};const b={join({commit:e},t){return S(this,void 0,void 0,(function*(){try{e("LOADING_START");const n=yield a.Qs.join(t).loadMessages();e("LOADING_SUCCESS",{channel:t,messages:n})}catch(n){throw e("LOADING_ERROR",n),n}}))},leave({getters:e,commit:t},n){return S(this,void 0,void 0,(function*(){const s=null!==n?[n]:e.joinedChannels;s.forEach((e=>{a.Qs.leave(e),t("CLEAR_CHANNEL",e)}))}))},inviteUser({commit:e},{channel:t,username:n}){return S(this,void 0,void 0,(function*(){const s=yield a.cG.inviteUser(t,n);s&&T.Z.create({message:s.message}),e("LOADING_ERROR",s)}))},revokeUser({commit:e},{channel:t,username:n}){var s;return S(this,void 0,void 0,(function*(){const o=yield null===(s=a.Qs["in"](t))||void 0===s?void 0:s.revokeUser(n);o&&T.Z.create({message:o.message}),e("LOADING_ERROR",o)}))},leaveChannel({commit:e},{channel:t}){var n;return S(this,void 0,void 0,(function*(){const s=yield null===(n=a.Qs["in"](t))||void 0===n?void 0:n.leaveChannel();s&&T.Z.create({message:s.message}),e("LOADING_ERROR",s)}))},addMessage({commit:e},{channel:t,message:n}){var s;return S(this,void 0,void 0,(function*(){const o=yield null===(s=a.Qs["in"](t))||void 0===s?void 0:s.addMessage(n);e("NEW_MESSAGE",{channel:t,message:o})}))},setChannelFilter({commit:e},t){e("SET_FILTER",t)},getMembers({commit:e},t){var n;return S(this,void 0,void 0,(function*(){const s=yield null===(n=a.Qs["in"](t))||void 0===n?void 0:n.getMembers();s&&e("SET_CHANNEL_MEMBERS",{channel:t,channelMembers:s})}))},setUserStatus({commit:e},{user:t,statusId:n}){e("SET_USER_STATUS",{user:t,statusId:n})}},E=b,A={joinedChannels(e){return""===e.channelFilter?Object.keys(e.messages):Object.keys(e.messages).filter((t=>t.indexOf(e.channelFilter)>=0))},currentMessages(e){return null!==e.active?e.messages[e.active]:[]},lastMessageOf(e){return t=>{const n=e.messages[t];return n.length>0?n[n.length-1]:null}},channelMembers(e){return null!=e.active?e.channelMembers[e.active]:[]}},k=A,w={LOADING_START(e){e.loading=!0,e.error=null},LOADING_SUCCESS(e,{channel:t,messages:n}){e.loading=!1,e.messages[t]=n},LOADING_ERROR(e,t){e.loading=!1,e.error=t},CLEAR_CHANNEL(e,t){e.active=null,delete e.messages[t]},SET_ACTIVE(e,t){e.active=t},NEW_MESSAGE(e,{channel:t,message:n}){e.messages[t].push(n)},SET_FILTER(e,t){e.channelFilter=t},SET_CHANNEL_MEMBERS(e,{channel:t,channelMembers:n}){e.channelMembers[t]=n},SET_USER_STATUS(e,{user:t,statusId:n}){Object.values(e.channelMembers).forEach((e=>{console.log(e);const s=e.find((e=>e.id===t.id));console.log(s),s&&(s.state=n)}))}},_=w,C={namespaced:!0,actions:E,getters:k,mutations:_,state:y},O=C,R=Symbol("vuex-key"),U=(0,s.h)((function(){const e=(0,o.MT)({modules:{auth:p,channels:O},strict:!1});return e}));function M(){return(0,o.oR)(R)}}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.m=e,(()=>{var e=[];n.O=(t,s,o,r)=>{if(!s){var i=1/0;for(u=0;u<e.length;u++){for(var[s,o,r]=e[u],a=!0,c=0;c<s.length;c++)(!1&r||i>=r)&&Object.keys(n.O).every((e=>n.O[e](s[c])))?s.splice(c--,1):(a=!1,r<i&&(i=r));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[s,o,r]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,s)=>(n.f[s](e,t),t)),[]))})(),(()=>{n.u=e=>"js/"+e+"."+{68:"ab259ff9",230:"be3cb77e",499:"c3b90b38",641:"21b0b25a",706:"8d81625e",728:"b6275080"}[e]+".js"})(),(()=>{n.miniCssF=e=>"css/"+{143:"app",736:"vendor"}[e]+"."+{143:"f6082e38",736:"905e3b87"}[e]+".css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="slate-messenger:";n.l=(s,o,r,i)=>{if(e[s])e[s].push(o);else{var a,c;if(void 0!==r)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var h=l[u];if(h.getAttribute("src")==s||h.getAttribute("data-webpack")==t+r){a=h;break}}a||(c=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+r),a.src=s),e[s]=[o];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(m);var o=e[s];if(delete e[s],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(n))),t)return t(n)},m=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.p=""})(),(()=>{var e={143:0};n.f.j=(t,s)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)s.push(o[2]);else{var r=new Promise(((n,s)=>o=e[t]=[n,s]));s.push(o[2]=r);var i=n.p+n.u(t),a=new Error,c=s=>{if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var r=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",a.name="ChunkLoadError",a.type=r,a.request=i,o[1](a)}};n.l(i,c,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,s)=>{var o,r,[i,a,c]=s,l=0;if(i.some((t=>0!==e[t]))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(c)var u=c(n)}for(t&&t(s);l<i.length;l++)r=i[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},s=globalThis["webpackChunkslate_messenger"]=globalThis["webpackChunkslate_messenger"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=n.O(void 0,[736],(()=>n(485)));s=n.O(s)})();